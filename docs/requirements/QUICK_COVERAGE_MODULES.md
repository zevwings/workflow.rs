# 快速覆盖率提升模块清单

## 🎯 优先级 1：极简单模块（< 10 行，预计 5-10 分钟）

### 1. `http/parser.rs` - 15/16 (94%)
- **未覆盖行数**: 1 行
- **难度**: ⭐ 极简单
- **预计时间**: 5 分钟
- **说明**: 只需补充一个边界条件测试

### 2. `http/response.rs` - 45/46 (98%)
- **未覆盖行数**: 1 行
- **难度**: ⭐ 极简单
- **预计时间**: 5 分钟
- **说明**: 只需补充一个错误处理测试

### 3. `prompt/summarize_pr.system.rs` - 0/7 (0%)
- **未覆盖行数**: 7 行
- **难度**: ⭐ 极简单
- **预计时间**: 5 分钟
- **说明**: 只是一个函数调用，测试 `generate_summarize_pr_system_prompt()`

---

## 🎯 优先级 2：简单对话框模块（预计 10-15 分钟）

### 4. `dialog/confirm.rs` - 8/16 (50%)
- **未覆盖行数**: 8 行
- **难度**: ⭐⭐ 简单
- **预计时间**: 10-15 分钟
- **说明**: 需要测试 `with_cancel_message()` 的错误分支和 `prompt()` 的各种情况
- **注意**: 可能需要 mock 用户输入或使用 `#[ignore]` 标记交互式测试

### 5. `dialog/multi_select.rs` - 5/15 (33%)
- **未覆盖行数**: 10 行
- **难度**: ⭐⭐ 简单
- **预计时间**: 10-15 分钟
- **说明**: 需要测试 `with_default()` 和 `prompt()` 的错误处理
- **注意**: 可能需要 mock 用户输入

### 6. `dialog/select.rs` - 13/22 (59%)
- **未覆盖行数**: 9 行
- **难度**: ⭐⭐ 简单
- **预计时间**: 10-15 分钟
- **说明**: 需要测试 `with_default()` 和 `prompt()` 的错误处理
- **注意**: 可能需要 mock 用户输入

---

## 🎯 优先级 3：配置管理模块（预计 15-20 分钟）

### 7. `mcp/config.rs` - 0/33 (0%)
- **未覆盖行数**: 33 行
- **难度**: ⭐⭐⭐ 中等
- **预计时间**: 15-20 分钟
- **说明**: 需要测试配置文件的读写、合并、检测等功能
- **优势**: 可以使用 `TempDir` 进行文件系统测试，无需 mock

### 8. `shell/reload.rs` - 0/29 (0%)
- **未覆盖行数**: 29 行
- **难度**: ⭐⭐⭐ 中等
- **预计时间**: 15-20 分钟
- **说明**: 需要测试 shell 重载功能
- **注意**: 可能需要 mock shell 命令或使用 `#[ignore]` 标记需要实际 shell 的测试

---

## 🎯 优先级 4：较大模块（预计 30+ 分钟）

### 9. `dialog/form/builder.rs` - 0/137 (0%)
- **未覆盖行数**: 137 行
- **难度**: ⭐⭐⭐⭐ 较难
- **预计时间**: 30+ 分钟
- **说明**: 表单构建器，需要测试各种构建方法和条件逻辑
- **注意**: 可能需要 mock 用户交互

### 10. `dialog/form/field_builder.rs` - 0/61 (0%)
- **未覆盖行数**: 61 行
- **难度**: ⭐⭐⭐ 中等
- **预计时间**: 20-30 分钟
- **说明**: 字段构建器，相对简单

### 11. `dialog/form/group_builder.rs` - 0/39 (0%)
- **未覆盖行数**: 39 行
- **难度**: ⭐⭐⭐ 中等
- **预计时间**: 15-20 分钟
- **说明**: 组构建器，相对简单

### 12. `dialog/form/types.rs` - 0/44 (0%)
- **未覆盖行数**: 44 行
- **难度**: ⭐⭐ 简单
- **预计时间**: 10-15 分钟
- **说明**: 类型定义，主要是结构体和枚举的测试

### 13. `indicator/progress.rs` - 0/40 (0%)
- **未覆盖行数**: 40 行
- **难度**: ⭐⭐⭐ 中等
- **预计时间**: 20-30 分钟
- **说明**: 进度指示器，可能需要终端模拟

---

## 📊 快速提升策略

### 推荐顺序（按效率排序）

1. **第一轮（极简单，5-10 分钟）**：
   - `http/parser.rs` (+0.01%)
   - `http/response.rs` (+0.01%)
   - `prompt/summarize_pr.system.rs` (+0.05%)

2. **第二轮（简单对话框，30-45 分钟）**：
   - `dialog/confirm.rs` (+0.1%)
   - `dialog/multi_select.rs` (+0.1%)
   - `dialog/select.rs` (+0.1%)

3. **第三轮（配置管理，30-40 分钟）**：
   - `mcp/config.rs` (+0.2%)
   - `shell/reload.rs` (+0.2%)

4. **第四轮（表单构建器，60+ 分钟）**：
   - `dialog/form/types.rs` (+0.1%)
   - `dialog/form/group_builder.rs` (+0.1%)
   - `dialog/form/field_builder.rs` (+0.2%)
   - `dialog/form/builder.rs` (+0.5%)

### 预计总提升

完成前两轮（优先级 1-2）预计可以提升 **+0.4%** 覆盖率，耗时约 **1 小时**。

完成前三轮（优先级 1-3）预计可以提升 **+0.8%** 覆盖率，耗时约 **2 小时**。

完成所有模块预计可以提升 **+1.5%** 覆盖率，耗时约 **4-5 小时**。

---

## 💡 测试编写建议

### 对于对话框模块
- 使用 `#[ignore]` 标记需要用户交互的测试
- 测试结构体创建和链式调用方法
- 测试错误处理分支（空选项、取消等）

### 对于配置管理模块
- 使用 `TempDir` 创建临时目录
- 测试文件不存在的情况（返回默认值）
- 测试配置读写、合并、更新等操作

### 对于 Prompt 模块
- 直接测试函数返回值
- 验证返回的字符串格式和内容

### 对于 HTTP 模块
- 测试边界条件（空响应、错误状态码等）
- 使用 mock 数据测试解析逻辑

