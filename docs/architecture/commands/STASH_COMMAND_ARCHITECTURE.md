# Stash å‘½ä»¤æ¨¡å—æ¶æ„æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿° Workflow CLI çš„ Stash å‘½ä»¤æ¨¡å—æ¶æ„ï¼ŒåŒ…æ‹¬ï¼š
- Stash list åŠŸèƒ½ï¼ˆåˆ—å‡ºæ‰€æœ‰ stash æ¡ç›®ï¼‰
- Stash apply åŠŸèƒ½ï¼ˆåº”ç”¨ stashï¼Œä¿ç•™æ¡ç›®ï¼‰
- Stash drop åŠŸèƒ½ï¼ˆåˆ é™¤ stash æ¡ç›®ï¼‰
- Stash pop åŠŸèƒ½ï¼ˆåº”ç”¨å¹¶åˆ é™¤ stash æ¡ç›®ï¼‰
- Stash push åŠŸèƒ½ï¼ˆä¿å­˜å½“å‰å·¥ä½œåŒºæ›´æ”¹åˆ° stashï¼‰

Stash å‘½ä»¤æ¨¡å—æä¾›å®Œæ•´çš„ Git Stash ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒæŸ¥çœ‹ã€åº”ç”¨ã€åˆ é™¤ã€ä¿å­˜ stash æ¡ç›®ã€‚æ‰€æœ‰å‘½ä»¤éƒ½æä¾›äº¤äº’å¼ç•Œé¢ï¼Œæ”¯æŒé€‰æ‹©ç‰¹å®šçš„ stash æ¡ç›®è¿›è¡Œæ“ä½œã€‚apply å’Œ pop å‘½ä»¤ä¼šè‡ªåŠ¨æ£€æµ‹å†²çªå¹¶æä¾›å‹å¥½çš„é”™è¯¯æç¤ºã€‚

**å®šä½**ï¼šå‘½ä»¤å±‚ä¸“æ³¨äºç”¨æˆ·äº¤äº’ã€å‚æ•°è§£æå’Œè¾“å‡ºæ ¼å¼åŒ–ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ç”± `lib/git/stash.rs` æ¨¡å—æä¾›ã€‚

**æ¨¡å—ç»Ÿè®¡ï¼š**
- å‘½ä»¤æ•°é‡ï¼š5 ä¸ªï¼ˆlistã€applyã€dropã€popã€pushï¼‰
- æ€»ä»£ç è¡Œæ•°ï¼šçº¦ 400 è¡Œ
- æ–‡ä»¶æ•°é‡ï¼š6 ä¸ª
- ä¸»è¦ä¾èµ–ï¼š`lib/git/stash.rs`ã€`lib/base/dialog/`ã€`lib/base/util/`

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

### CLI å…¥å£å±‚

```
src/bin/workflow.rs
```
- **èŒè´£**ï¼š`workflow` ä¸»å‘½ä»¤å…¥å£ï¼Œè´Ÿè´£å‘½ä»¤è¡Œå‚æ•°è§£æå’Œå‘½ä»¤åˆ†å‘
- **åŠŸèƒ½**ï¼šä½¿ç”¨ `clap` è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œå°† `workflow stash` å­å‘½ä»¤åˆ†å‘åˆ°å¯¹åº”çš„å‘½ä»¤å¤„ç†å‡½æ•°

### å‘½ä»¤å°è£…å±‚

```
src/commands/stash/
â”œâ”€â”€ mod.rs          # Stash å‘½ä»¤æ¨¡å—å£°æ˜ï¼ˆ6 è¡Œï¼‰
â”œâ”€â”€ list.rs         # Stash list å‘½ä»¤ï¼ˆ94 è¡Œï¼‰
â”œâ”€â”€ apply.rs        # Stash apply å‘½ä»¤ï¼ˆ83 è¡Œï¼‰
â”œâ”€â”€ drop.rs         # Stash drop å‘½ä»¤ï¼ˆçº¦ 100 è¡Œï¼‰
â”œâ”€â”€ pop.rs          # Stash pop å‘½ä»¤ï¼ˆ72 è¡Œï¼‰
â”œâ”€â”€ push.rs         # Stash push å‘½ä»¤ï¼ˆ56 è¡Œï¼‰
â””â”€â”€ helpers.rs      # è¾…åŠ©å‡½æ•°ï¼ˆäº¤äº’å¼é€‰æ‹© stashï¼‰
```

**èŒè´£**ï¼š
- è§£æå‘½ä»¤å‚æ•°
- å¤„ç†ç”¨æˆ·äº¤äº’ï¼ˆé€‰æ‹©ã€ç¡®è®¤ç­‰ï¼‰
- æ ¼å¼åŒ–è¾“å‡ºï¼ˆè¡¨æ ¼æ˜¾ç¤ºï¼‰
- è°ƒç”¨æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚ (`lib/git/stash.rs`) çš„åŠŸèƒ½
- å¤„ç†å†²çªå’Œé”™è¯¯æƒ…å†µ

### ä¾èµ–æ¨¡å—

å‘½ä»¤å±‚é€šè¿‡è°ƒç”¨ `lib/` æ¨¡å—æä¾›çš„ API å®ç°åŠŸèƒ½ï¼Œå…·ä½“å®ç°ç»†èŠ‚è¯·å‚è€ƒç›¸å…³æ¨¡å—æ–‡æ¡£ï¼š
- **`lib/git/stash.rs`**ï¼šGit Stash æ“ä½œ
  - `GitStash::stash_list()` - åˆ—å‡ºæ‰€æœ‰ stash æ¡ç›®
  - `GitStash::stash_push()` - ä¿å­˜å½“å‰å·¥ä½œåŒºæ›´æ”¹åˆ° stash
  - `GitStash::stash_apply()` - åº”ç”¨ stashï¼ˆä¸åˆ é™¤ï¼‰
  - `GitStash::stash_drop()` - åˆ é™¤ stash
  - `GitStash::stash_pop()` - åº”ç”¨å¹¶åˆ é™¤ stash
  - `GitStash::stash_show_stat()` - è·å– stash ç»Ÿè®¡ä¿¡æ¯
  - `GitStash::has_unmerged()` - æ£€æŸ¥æ˜¯å¦æœ‰å†²çª
- **`lib/base/dialog/`**ï¼šç”¨æˆ·äº¤äº’å¯¹è¯æ¡†
  - `ConfirmDialog` - ç¡®è®¤å¯¹è¯æ¡†
  - `SelectDialog` - é€‰æ‹©å¯¹è¯æ¡†
  - `MultiSelectDialog` - å¤šé€‰å¯¹è¯æ¡†
- **`lib/base/util/`**ï¼šå·¥å…·å‡½æ•°
  - `TableBuilder` - è¡¨æ ¼æ„å»ºå™¨
  - `TableStyle` - è¡¨æ ¼æ ·å¼

è¯¦ç»†æ¶æ„æ–‡æ¡£ï¼šå‚è§ [Git æ¨¡å—æ¶æ„æ–‡æ¡£](../lib/GIT_ARCHITECTURE.md)

---

## ğŸ”„ è°ƒç”¨æµç¨‹

### æ•´ä½“æ¶æ„æµç¨‹

```
ç”¨æˆ·è¾“å…¥
  â†“
src/bin/workflow.rs (workflow ä¸»å‘½ä»¤ï¼Œå‚æ•°è§£æ)
  â†“
commands/stash/*.rs (å‘½ä»¤å°è£…å±‚ï¼Œå¤„ç†äº¤äº’)
  â†“
lib/git/stash.rs (ä¸šåŠ¡é€»è¾‘å±‚ï¼ŒGit æ“ä½œ)
  â†“
Git å‘½ä»¤æ‰§è¡Œ
```

### å„å‘½ä»¤è¯¦ç»†æµç¨‹

#### 1. `stash list` å‘½ä»¤æµç¨‹

```
ç”¨æˆ·è¾“å…¥: workflow stash list [--stat]
  â†“
StashListCommand::execute(show_stat)
  â†“
GitStash::stash_list() â†’ è·å–æ‰€æœ‰ stash æ¡ç›®
  â†“
æ ¼å¼åŒ–è¡¨æ ¼æ•°æ® (StashRow)
  â†“
TableBuilder æ„å»ºè¡¨æ ¼
  â†“
æ˜¾ç¤ºè¡¨æ ¼ï¼ˆå¦‚æœ --statï¼Œæ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼‰
```

#### 2. `stash apply` å‘½ä»¤æµç¨‹

```
ç”¨æˆ·è¾“å…¥: workflow stash apply
  â†“
StashApplyCommand::execute()
  â†“
GitStash::stash_list() â†’ è·å–æ‰€æœ‰ stash æ¡ç›®
  â†“
æ˜¾ç¤ºæœ€æ–° stash ä¿¡æ¯ï¼Œè¯¢é—®æ˜¯å¦åº”ç”¨
  â†“
å¦‚æœç”¨æˆ·é€‰æ‹©å…¶ä»–ï¼Œè°ƒç”¨ select_stash_interactively()
  â†“
GitStash::stash_apply(stash_ref) â†’ åº”ç”¨ stash
  â†“
æ£€æŸ¥å†²çª (GitStash::has_unmerged())
  â†“
æ˜¾ç¤ºç»“æœï¼ˆæˆåŠŸ/å†²çª/é”™è¯¯ï¼‰
```

#### 3. `stash drop` å‘½ä»¤æµç¨‹

```
ç”¨æˆ·è¾“å…¥: workflow stash drop
  â†“
StashDropCommand::execute()
  â†“
GitStash::stash_list() â†’ è·å–æ‰€æœ‰ stash æ¡ç›®
  â†“
MultiSelectDialog å¤šé€‰è¦åˆ é™¤çš„ stash
  â†“
æ˜¾ç¤ºå°†è¦åˆ é™¤çš„ stash åˆ—è¡¨
  â†“
ç¡®è®¤åˆ é™¤
  â†“
GitStash::stash_drop(stash_ref) â†’ åˆ é™¤æ¯ä¸ªé€‰ä¸­çš„ stash
  â†“
æ˜¾ç¤ºåˆ é™¤ç»“æœ
```

#### 4. `stash pop` å‘½ä»¤æµç¨‹

```
ç”¨æˆ·è¾“å…¥: workflow stash pop
  â†“
StashPopCommand::execute()
  â†“
GitStash::stash_list() â†’ è·å–æ‰€æœ‰ stash æ¡ç›®
  â†“
æ˜¾ç¤ºæœ€æ–° stash ä¿¡æ¯ï¼Œè¯¢é—®æ˜¯å¦åº”ç”¨
  â†“
å¦‚æœç”¨æˆ·é€‰æ‹©å…¶ä»–ï¼Œè°ƒç”¨ select_stash_interactively()
  â†“
GitStash::stash_pop(stash_ref) â†’ åº”ç”¨å¹¶åˆ é™¤ stash
  â†“
æ£€æŸ¥å†²çª (GitStash::has_unmerged())
  â†“
å¦‚æœå†²çªï¼Œä¿ç•™ stash æ¡ç›®
  â†“
æ˜¾ç¤ºç»“æœï¼ˆæˆåŠŸ/å†²çª/é”™è¯¯ï¼‰
```

#### 5. `stash push` å‘½ä»¤æµç¨‹

```
ç”¨æˆ·è¾“å…¥: workflow stash push
  â†“
StashPushCommand::execute()
  â†“
GitCommit::has_commit() â†’ æ£€æŸ¥æ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹
  â†“
å¦‚æœæ²¡æœ‰æ›´æ”¹ï¼Œæ˜¾ç¤ºè­¦å‘Šå¹¶è¿”å›
  â†“
InputDialog æç¤ºè¾“å…¥ stash æ¶ˆæ¯ï¼ˆå¯é€‰ï¼‰
  â†“
GitStash::stash_push(message) â†’ ä¿å­˜æ›´æ”¹åˆ° stash
  â†“
æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
```

---

## åŠŸèƒ½è¯´æ˜

### 1. `stash list` - åˆ—å‡ºæ‰€æœ‰ stash

**åŠŸèƒ½æè¿°**ï¼š
åˆ—å‡ºæ‰€æœ‰ stash æ¡ç›®ï¼Œä»¥è¡¨æ ¼å½¢å¼æ˜¾ç¤ºç´¢å¼•ã€æ¶ˆæ¯ã€åˆ†æ”¯å’Œåˆ›å»ºæ—¶é—´ã€‚

**å‘½ä»¤æ ¼å¼**ï¼š
```bash
workflow stash list              # åˆ—å‡ºæ‰€æœ‰ stash
workflow stash list --stat       # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
```

**å®ç°ç»†èŠ‚**ï¼š
- ä½¿ç”¨ `GitStash::stash_list()` è·å–æ‰€æœ‰ stash æ¡ç›®
- ä½¿ç”¨ `TableBuilder` æ„å»ºè¡¨æ ¼ï¼Œæ˜¾ç¤ºç´¢å¼•ã€æ¶ˆæ¯ã€åˆ†æ”¯ã€åˆ›å»ºæ—¶é—´
- å¦‚æœæŒ‡å®š `--stat`ï¼Œä½¿ç”¨ `GitStash::stash_show_stat()` è·å–æ¯ä¸ª stash çš„æ–‡ä»¶å˜æ›´ç»Ÿè®¡

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
Stash Entries
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #           â”‚ Message              â”‚ Branch   â”‚ Created             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ stash@{0}   â”‚ WIP: feature branch  â”‚ feature  â”‚ 2025-01-27 10:30:00 â”‚
â”‚ stash@{1}   â”‚ Temporary changes     â”‚ main     â”‚ 2025-01-26 15:20:00 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. `stash apply` - åº”ç”¨ stash

**åŠŸèƒ½æè¿°**ï¼š
åº”ç”¨æŒ‡å®šçš„ stashï¼Œä¿ç•™ stash æ¡ç›®ï¼ˆä¸åˆ é™¤ï¼‰ã€‚

**å‘½ä»¤æ ¼å¼**ï¼š
```bash
workflow stash apply              # äº¤äº’å¼é€‰æ‹©è¦åº”ç”¨çš„ stash
```

**å®ç°ç»†èŠ‚**ï¼š
- é¦–å…ˆæ˜¾ç¤ºæœ€æ–°çš„ stash ä¿¡æ¯ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦åº”ç”¨
- å¦‚æœç”¨æˆ·é€‰æ‹©å…¶ä»–ï¼Œä½¿ç”¨ `select_stash_interactively()` äº¤äº’å¼é€‰æ‹©
- ä½¿ç”¨ `GitStash::stash_apply()` åº”ç”¨ stash
- è‡ªåŠ¨æ£€æµ‹å†²çªï¼ˆ`GitStash::has_unmerged()`ï¼‰
- å¦‚æœæˆåŠŸï¼Œæ˜¾ç¤ºæ–‡ä»¶å˜æ›´ç»Ÿè®¡ï¼›å¦‚æœæœ‰å†²çªï¼Œæ˜¾ç¤ºå†²çªæç¤º

**å†²çªå¤„ç†**ï¼š
- å¦‚æœåº”ç”¨æ—¶å‘ç”Ÿå†²çªï¼Œstash æ¡ç›®ä¿ç•™
- æ˜¾ç¤ºå†²çªæç¤ºå’Œè§£å†³æ­¥éª¤

### 3. `stash drop` - åˆ é™¤ stash

**åŠŸèƒ½æè¿°**ï¼š
åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ª stash æ¡ç›®ã€‚

**å‘½ä»¤æ ¼å¼**ï¼š
```bash
workflow stash drop               # äº¤äº’å¼é€‰æ‹©è¦åˆ é™¤çš„ stash
```

**å®ç°ç»†èŠ‚**ï¼š
- ä½¿ç”¨ `MultiSelectDialog` å¤šé€‰è¦åˆ é™¤çš„ stash
- æ˜¾ç¤ºå°†è¦åˆ é™¤çš„ stash åˆ—è¡¨ä¾›ç”¨æˆ·ç¡®è®¤
- ä½¿ç”¨ `GitStash::stash_drop()` åˆ é™¤æ¯ä¸ªé€‰ä¸­çš„ stash
- æ˜¾ç¤ºåˆ é™¤ç»“æœ

**å®‰å…¨æœºåˆ¶**ï¼š
- å¤šé€‰ç¡®è®¤ï¼Œé¿å…è¯¯åˆ 
- æ˜¾ç¤ºå°†è¦åˆ é™¤çš„ stash åˆ—è¡¨
- äºŒæ¬¡ç¡®è®¤æœºåˆ¶

### 4. `stash pop` - åº”ç”¨å¹¶åˆ é™¤ stash

**åŠŸèƒ½æè¿°**ï¼š
åº”ç”¨æŒ‡å®šçš„ stash å¹¶åˆ é™¤è¯¥ stash æ¡ç›®ã€‚

**å‘½ä»¤æ ¼å¼**ï¼š
```bash
workflow stash pop                # äº¤äº’å¼é€‰æ‹©è¦åº”ç”¨çš„ stash
```

**å®ç°ç»†èŠ‚**ï¼š
- é¦–å…ˆæ˜¾ç¤ºæœ€æ–°çš„ stash ä¿¡æ¯ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦åº”ç”¨
- å¦‚æœç”¨æˆ·é€‰æ‹©å…¶ä»–ï¼Œä½¿ç”¨ `select_stash_interactively()` äº¤äº’å¼é€‰æ‹©
- ä½¿ç”¨ `GitStash::stash_pop()` åº”ç”¨å¹¶åˆ é™¤ stash
- è‡ªåŠ¨æ£€æµ‹å†²çªï¼ˆ`GitStash::has_unmerged()`ï¼‰
- **é‡è¦**ï¼šå¦‚æœåº”ç”¨å¤±è´¥ï¼ˆå†²çªï¼‰ï¼Œstash æ¡ç›®ä¿ç•™ï¼Œä¸åˆ é™¤

**å†²çªå¤„ç†**ï¼š
- å¦‚æœåº”ç”¨æ—¶å‘ç”Ÿå†²çªï¼Œstash æ¡ç›®ä¿ç•™ï¼ˆä¸åˆ é™¤ï¼‰
- æ˜¾ç¤ºå†²çªæç¤ºå’Œè§£å†³æ­¥éª¤
- ç”¨æˆ·è§£å†³å†²çªåå¯ä»¥å†æ¬¡å°è¯•

### 5. `stash push` - ä¿å­˜å½“å‰æ›´æ”¹åˆ° stash

**åŠŸèƒ½æè¿°**ï¼š
å°†å½“å‰å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„æœªæäº¤æ›´æ”¹ä¿å­˜åˆ° stashã€‚æ”¯æŒå¯é€‰çš„ stash æ¶ˆæ¯æ¥æ ‡è¯†è¿™æ¬¡ä¿å­˜çš„å†…å®¹ã€‚

**å‘½ä»¤æ ¼å¼**ï¼š
```bash
workflow stash push                # ä¿å­˜å½“å‰æ›´æ”¹åˆ° stashï¼ˆæç¤ºè¾“å…¥æ¶ˆæ¯ï¼‰
```

**å®ç°ç»†èŠ‚**ï¼š
- é¦–å…ˆæ£€æŸ¥å·¥ä½œåŒºæ˜¯å¦æœ‰æœªæäº¤çš„æ›´æ”¹ï¼ˆ`GitCommit::has_commit()`ï¼‰
- å¦‚æœæ²¡æœ‰æ›´æ”¹ï¼Œæ˜¾ç¤ºè­¦å‘Šå¹¶è¿”å›
- ä½¿ç”¨ `InputDialog` æç¤ºç”¨æˆ·è¾“å…¥å¯é€‰çš„ stash æ¶ˆæ¯
- ä½¿ç”¨ `GitStash::stash_push()` ä¿å­˜æ›´æ”¹åˆ° stash
- æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯ï¼ˆåŒ…å«æ¶ˆæ¯å†…å®¹ï¼Œå¦‚æœæœ‰ï¼‰

**ä½¿ç”¨åœºæ™¯**ï¼š
- ä¸´æ—¶ä¿å­˜å½“å‰å·¥ä½œè¿›åº¦ï¼Œåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯
- åœ¨åˆ‡æ¢åˆ†æ”¯å‰ä¿å­˜æœªæäº¤çš„æ›´æ”¹
- ä¿å­˜å®éªŒæ€§æ›´æ”¹ï¼Œç¨åæ¢å¤

---

## ğŸ“Š æ•°æ®æµ

### Stash æ•°æ®ç»“æ„

```rust
// lib/git/stash.rs
pub struct StashEntry {
    pub index: usize,              // stash@{n} ä¸­çš„ n
    pub branch: String,             // åˆ›å»ºæ—¶çš„åˆ†æ”¯
    pub message: String,             // stash æ¶ˆæ¯
    pub commit_hash: String,        // commit hash
    pub timestamp: Option<DateTime<Local>>,  // åˆ›å»ºæ—¶é—´
}

pub struct StashApplyResult {
    pub applied: bool,               // æ˜¯å¦æˆåŠŸåº”ç”¨
    pub has_conflicts: bool,         // æ˜¯å¦æœ‰å†²çª
    pub message: Option<String>,     // æ¶ˆæ¯
    pub warnings: Vec<String>,       // è­¦å‘Šåˆ—è¡¨
    pub stat: Option<StashStat>,     // ç»Ÿè®¡ä¿¡æ¯
}

pub struct StashStat {
    pub files_changed: usize,        // å˜æ›´çš„æ–‡ä»¶æ•°
    pub insertions: usize,           // æ’å…¥çš„è¡Œæ•°
    pub deletions: usize,            // åˆ é™¤çš„è¡Œæ•°
}
```

### æ•°æ®æµå‘

```
Git å‘½ä»¤è¾“å‡º
  â†“
GitStash::stash_list() â†’ Vec<StashEntry>
  â†“
å‘½ä»¤å±‚æ ¼å¼åŒ– â†’ è¡¨æ ¼æ˜¾ç¤º
```

---

## ğŸ”— ä¸å…¶ä»–æ¨¡å—çš„é›†æˆ

### ä¸ Git æ¨¡å—çš„é›†æˆ

- **`lib/git/stash.rs`**ï¼šæä¾›æ‰€æœ‰ stash æ“ä½œçš„åº•å±‚å®ç°
- ä½¿ç”¨ `git stash` å‘½ä»¤æ‰§è¡Œå®é™…æ“ä½œ
- æä¾›å†²çªæ£€æµ‹åŠŸèƒ½

### ä¸ Dialog æ¨¡å—çš„é›†æˆ

- **`lib/base/dialog/`**ï¼šæä¾›äº¤äº’å¼å¯¹è¯æ¡†
- `ConfirmDialog`ï¼šç¡®è®¤æ“ä½œ
- `SelectDialog`ï¼šå•é€‰ stash
- `MultiSelectDialog`ï¼šå¤šé€‰ stashï¼ˆç”¨äº drop å‘½ä»¤ï¼‰

### ä¸ Util æ¨¡å—çš„é›†æˆ

- **`lib/base/util/`**ï¼šæä¾›å·¥å…·å‡½æ•°
- `TableBuilder`ï¼šæ„å»ºè¡¨æ ¼è¾“å‡º
- `TableStyle`ï¼šè¡¨æ ¼æ ·å¼

---

## ğŸ¯ è®¾è®¡æ¨¡å¼

### 1. å‘½ä»¤æ¨¡å¼

æ¯ä¸ª stash å­å‘½ä»¤éƒ½å°è£…åœ¨ç‹¬ç«‹çš„å‘½ä»¤ç»“æ„ä½“ä¸­ï¼š
- `StashListCommand`
- `StashApplyCommand`
- `StashDropCommand`
- `StashPopCommand`
- `StashPushCommand`

### 2. äº¤äº’å¼è®¾è®¡

æ‰€æœ‰å‘½ä»¤éƒ½æä¾›äº¤äº’å¼ç•Œé¢ï¼š
- è‡ªåŠ¨æ£€æµ‹ stash åˆ—è¡¨
- æä¾›å‹å¥½çš„é€‰æ‹©ç•Œé¢
- æ˜¾ç¤ºæ¸…æ™°çš„ç¡®è®¤ä¿¡æ¯

### 3. é”™è¯¯å¤„ç†

- ä½¿ç”¨ `anyhow::Result` ç»Ÿä¸€é”™è¯¯å¤„ç†
- æä¾›è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯
- å†²çªæ£€æµ‹å’Œæç¤º

---

## ğŸ” é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯æƒ…å†µ

1. **æ²¡æœ‰ stash æ¡ç›®**
   - `stash list`ï¼šæ˜¾ç¤º "No stash entries found"
   - `stash apply/pop/drop`ï¼šæ˜¾ç¤ºè­¦å‘Šå¹¶è¿”å›

2. **åº”ç”¨å†²çª**
   - æ£€æµ‹åˆ°å†²çªæ—¶ï¼Œæ˜¾ç¤ºå†²çªæç¤º
   - `stash pop` åœ¨å†²çªæ—¶ä¿ç•™ stash æ¡ç›®
   - æä¾›è§£å†³å†²çªçš„æ­¥éª¤æç¤º

3. **åˆ é™¤å¤±è´¥**
   - æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
   - ä¿ç•™å…¶ä»– stash æ¡ç›®

### é”™è¯¯æ¶ˆæ¯ç¤ºä¾‹

```
Warning: No stash entries available
Warning: Merge conflicts detected!
Warning: Please resolve conflicts manually:
  1. Resolve conflicts in the affected files
  2. Stage the resolved files with: git add <file>
  3. Continue with your workflow
```

---

## ğŸ“ æ‰©å±•æ€§

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ·»åŠ æ–°çš„ stash æ“ä½œ**ï¼š
   - åœ¨ `src/lib/cli/stash.rs` ä¸­æ·»åŠ æ–°çš„å­å‘½ä»¤æšä¸¾
   - åœ¨ `src/commands/stash/` ä¸­åˆ›å»ºæ–°çš„å‘½ä»¤æ–‡ä»¶
   - åœ¨ `src/lib/git/stash.rs` ä¸­æ·»åŠ åº•å±‚å®ç°ï¼ˆå¦‚éœ€è¦ï¼‰

2. **æ‰©å±•è¾“å‡ºæ ¼å¼**ï¼š
   - å¯ä»¥æ·»åŠ  JSON/YAML è¾“å‡ºæ ¼å¼ï¼ˆå‚è€ƒ Jira å‘½ä»¤ï¼‰
   - ä½¿ç”¨ `OutputFormatArgs` å…±ç”¨å‚æ•°

3. **æ·»åŠ è¿‡æ»¤é€‰é¡¹**ï¼š
   - å¯ä»¥æ·»åŠ æŒ‰åˆ†æ”¯ã€æ—¶é—´ç­‰è¿‡æ»¤ stash çš„åŠŸèƒ½

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Git æ¨¡å—æ¶æ„æ–‡æ¡£](../lib/GIT_ARCHITECTURE.md) - Git æ“ä½œåº•å±‚å®ç°
- [CLI æ¶æ„æ–‡æ¡£](../CLI_ARCHITECTURE.md) - CLI å‘½ä»¤ç»“æ„è®¾è®¡
- [å¼€å‘è§„èŒƒæ–‡æ¡£](../../guidelines/DEVELOPMENT_GUIDELINES.md) - ä»£ç é£æ ¼å’Œå¼€å‘è§„èŒƒ

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åˆ—å‡ºæ‰€æœ‰ stash

```bash
# åˆ—å‡ºæ‰€æœ‰ stash
workflow stash list

# åˆ—å‡ºæ‰€æœ‰ stash å¹¶æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
workflow stash list --stat
```

### åº”ç”¨ stash

```bash
# åº”ç”¨æœ€æ–°çš„ stashï¼ˆäº¤äº’å¼ç¡®è®¤ï¼‰
workflow stash apply

# æµç¨‹ï¼š
# 1. æ˜¾ç¤ºæœ€æ–° stash ä¿¡æ¯
# 2. è¯¢é—®æ˜¯å¦åº”ç”¨
# 3. å¦‚æœé€‰æ‹©å…¶ä»–ï¼Œæ˜¾ç¤ºåˆ—è¡¨ä¾›é€‰æ‹©
# 4. åº”ç”¨ stash
# 5. æ˜¾ç¤ºç»“æœï¼ˆæˆåŠŸ/å†²çªï¼‰
```

### åˆ é™¤ stash

```bash
# åˆ é™¤ stashï¼ˆäº¤äº’å¼å¤šé€‰ï¼‰
workflow stash drop

# æµç¨‹ï¼š
# 1. æ˜¾ç¤ºæ‰€æœ‰ stash åˆ—è¡¨
# 2. å¤šé€‰è¦åˆ é™¤çš„ stash
# 3. æ˜¾ç¤ºå°†è¦åˆ é™¤çš„åˆ—è¡¨
# 4. ç¡®è®¤åˆ é™¤
# 5. æ‰§è¡Œåˆ é™¤
```

### åº”ç”¨å¹¶åˆ é™¤ stash

```bash
# åº”ç”¨å¹¶åˆ é™¤æœ€æ–°çš„ stashï¼ˆäº¤äº’å¼ç¡®è®¤ï¼‰
workflow stash pop

# æµç¨‹ï¼š
# 1. æ˜¾ç¤ºæœ€æ–° stash ä¿¡æ¯
# 2. è¯¢é—®æ˜¯å¦åº”ç”¨
# 3. å¦‚æœé€‰æ‹©å…¶ä»–ï¼Œæ˜¾ç¤ºåˆ—è¡¨ä¾›é€‰æ‹©
# 4. åº”ç”¨å¹¶åˆ é™¤ stash
# 5. å¦‚æœæœ‰å†²çªï¼Œä¿ç•™ stash æ¡ç›®
# 6. æ˜¾ç¤ºç»“æœ
```

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0
**æœ€åæ›´æ–°**ï¼š2025-01-27
