---
description: Development standards and guidelines, including code style, error handling, testing standards, Git workflow, and code review
type: always
---

# Development Standards and Guidelines

> **⚠️ Synchronization Note**: This file must be kept in sync with its Chinese version at `docs/cursorrules/development.md`. When modifying this file, you must immediately update the corresponding Chinese version.

---

## Development Standards and Guidelines

**Important**: All development standards and guidelines must strictly follow the detailed descriptions in `docs/guidelines/development/README.md`.

### Development Guidelines Reference

**Mandatory Development Guidelines Document**: `docs/guidelines/development/README.md` (Development Guidelines Index)

This directory contains complete development guidelines, including:
- **Core Guidelines**: Code style, error handling, naming conventions, module organization
- **Process Guidelines**: Git workflow, commit standards, code review
- **Reference Documents**: Logging, documentation, configuration management, security, dependency management, performance optimization, development tools, etc.

### Quick Reference

The following are the most commonly used standards quick reference (**for detailed descriptions and complete standards, see `docs/guidelines/development/README.md`**):

- **Code Formatting**: `cargo fmt` (must run before commit)
- **Code Checking**: `cargo clippy -- -D warnings` (all warnings must be fixed)
- **Naming Conventions**: Modules/functions/variables `snake_case`, Types/Traits `PascalCase`, Constants `SCREAMING_SNAKE_CASE`
- **Import Order**: Standard library → Third-party libraries → Project internal
- **Error Handling**: Use `color_eyre::Result<T>` and add context to error messages
- **Documentation Comments**: All public APIs must have `///` documentation comments, including parameters, return values, errors, examples

### Code Generation Rules

**Important**: Only execute code generation operations when the user explicitly requests code generation.

When generating code, must strictly follow all development standards in `docs/guidelines/development/` directory, including:

- **Code Style**: Follow project naming conventions and code style, use `rustfmt` for formatting, pass `clippy` checks
- **Error Handling**: Use `color_eyre::Result<T>`, add context to error messages, consider all error cases
- **Documentation Comments**: Add complete documentation comments for new features (including parameters, return values, errors, examples)
- **Document Writing**: If generating documents, must reference `docs/guidelines/document.md` to select appropriate templates, and add "Last Updated" timestamp at the end of documents (reference `docs/guidelines/document-timestamp.md`)
- **API Design**: Follow public API design principles, maintain backward compatibility, use `#[deprecated]` for deprecated APIs, reference `docs/guidelines/development/references/documentation.md` for detailed documentation standards
- **Module Organization**: Follow three-layer architecture, correctly organize modules and dependencies
- **Testing**: Add unit tests and integration tests for new features (as applicable)
- **Commit Standards**: If involving Git commits, follow Conventional Commits format
- **Code Quality**: Keep code concise and readable, follow Rust best practices (e.g., use `Result` types, avoid `unwrap()`, etc.)
- **Code Review**: Ensure code meets review checklist requirements

### Adding New Features

1. Implement core business logic in `lib/`
2. Add CLI command wrappers in `commands/`
3. Register commands in `main.rs`
4. Add test cases (reference testing standards)
5. Update documentation
6. **Extending PR Platform Support**: To add new PR platforms (e.g., GitLab, Bitbucket), reference `docs/guidelines/pr-platform.md`

### Git Workflow and Commit Standards

**Must Follow**: Git workflow and commit standards in `docs/guidelines/development/git-workflow.md` and `docs/guidelines/development/commit.md`.

- **Branch Strategy**: Use `feature/*`, `fix/*`, `hotfix/*` branches
- **Commit Format**: Use Conventional Commits format (`<type>(<scope>): <subject>`)
- **Commit Types**: `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`, `perf`, `ci`
- **Commit Message Requirements**: Subject line no more than 50 characters, use imperative mood

### Testing Standards

**Detailed Standards**: Reference `docs/guidelines/development/README.md` and `docs/guidelines/testing/README.md`.

- Unit tests placed in `#[cfg(test)]` modules of corresponding modules
- Integration tests placed in `tests/` directory
- Use `cargo test` to run tests
- Target coverage: > 80%, critical business logic: > 90%

### Code Review

**Review Checklist**: Reference `docs/guidelines/development/code-review.md` for code review standards.

**Code Review Workflow**:
- **Pre-commit Check** (5-15 minutes): Reference `docs/guidelines/workflows/pre-commit.md`
- **Comprehensive Deep Review** (2-4 hours): Reference `docs/guidelines/workflows/review.md` (after feature completion, periodic review, before major refactoring)

Before submitting PR, ensure:
- [ ] Code is formatted (`cargo fmt`)
- [ ] Passes Clippy checks (`cargo clippy`)
- [ ] All tests pass (`cargo test`)
- [ ] Added necessary documentation comments
- [ ] Followed error handling standards
- [ ] Commit messages meet standards

### Dependency Management

**Detailed Principles**: Reference `docs/guidelines/development/references/dependency-management.md` for dependency management standards.

- Use `cargo add <package-name>` to add dependencies
- Prefer stable versions of crates
- Avoid unnecessary dependencies
- Before adding new dependencies, consider if really needed, if there are lighter alternatives

### Development Tools

**Required Tools and Common Commands**: Reference `docs/guidelines/development/references/development-tools.md` for development tools standards (if created).

**CI/CD Configuration**:
- **CI Workflow Configuration**: Reference `docs/guidelines/ci-workflow.md`
- **GitHub Configuration**: Reference `docs/guidelines/github-setup.md` (Secrets, Variables, branch protection rules, etc.)

**Performance Analysis Tools**:
- **Binary Size Analysis**: Reference `docs/guidelines/cargo-bloat.md` (use `cargo-bloat` to analyze binary file size)

Install development tools: `make setup`

---

**Last Updated**: 2025-12-25
